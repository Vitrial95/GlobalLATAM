<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>LATAM Globe Ingenios</title>

    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: none;
      }

      #globeViz {
        width: auto;
        height: auto;
        overflow: hidden;
        font-family: "Orbitron", sans-serif;
      }

      @import url("https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap");

      .label-sci {
        background: rgba(0, 30, 40, 0.65);
        border: 1px solid rgba(0, 255, 150, 0.9);
        border-radius: 8px;
        padding: 4px 10px;
        font-size: 12px;
        color: #fff;
        text-shadow: 0 0 4px rgba(0, 255, 180, 0.75);
        box-shadow:
          0 0 8px rgba(0, 255, 180, 0.45),
          inset 0 0 4px rgba(0, 255, 180, 0.25);
        backdrop-filter: blur(5px);
        white-space: nowrap;
        pointer-events: auto;
        position: relative;
        display: inline-block;
        cursor: pointer;
      }

      /* TOOLTIP SCI-FI */
      .tooltip {
        display: none;
        position: absolute;
        top: 28px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 18, 28, 0.95);
        border: 1px solid rgba(0, 255, 160, 0.6);
        border-radius: 10px;
        padding: 10px 14px;
        font-size: 11px;
        max-width: 320px;
        box-shadow:
          0 0 10px rgba(0, 255, 160, 0.35),
          inset 0 0 6px rgba(0, 255, 160, 0.15);
        backdrop-filter: blur(6px);
        z-index: 10;
      }

      .label-sci:hover .tooltip {
        display: block;
      }

      /* LISTA HUD */
      .tooltip ul {
        list-style: none;
        padding: 0;
        margin: 0;
        position: relative;
      }

      /* Línea vertical HUD */
      .tooltip ul::before {
        content: "";
        position: absolute;
        left: 2px;
        top: 0;
        bottom: 0;
        width: 1px;
        background: linear-gradient(
          to bottom,
          transparent,
          rgba(0, 255, 160, 0.6),
          transparent
        );
      }

      .tooltip li {
        padding-left: 14px;
        margin-bottom: 6px;
        white-space: nowrap;
        position: relative;
        color: #eafff7;
        text-shadow: 0 0 4px rgba(0, 255, 160, 0.4);
      }

      /* Guión sci-fi */
      .tooltip li::before {
        content: "—";
        position: absolute;
        left: 0;
        color: rgba(0, 255, 160, 0.9);
        text-shadow: 0 0 6px rgba(0, 255, 160, 0.8);
      }
    </style>
  </head>

  <body>
    <div id="globeViz"></div>

    <script src="https://unpkg.com/three"></script>
    <script src="https://unpkg.com/globe.gl"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>

    <script>
      const latam = [
        "Argentina","Bolivia","Chile","Colombia","Costa Rica","Cuba",
        "Ecuador","Brazil","El Salvador","Guatemala","Haiti","Honduras",
        "Mexico","Nicaragua","Panama","Paraguay","Peru",
        "Republica Dominicana","Uruguay","Venezuela"
      ];

      const labels = [
        {
          name: "Guatemala",
          lat: 14.6,
          lng: -90.5,
          info: `Ingenio Concepción<br>Ingenio Santa Teresa<br>Ingenio La Unión<br>Ingenio Madre Tierra<br>Ingenio Tululá`,
        },
        {
          name: "Colombia",
          lat: 4.7,
          lng: -74.1,
          info: `Manuelita (Grupo Manuelita)<br>Ingenio San Carlos Colombia<br>Ingenio Pichichí<br>Ingenio María Luisa<br>Ingenio del Cauca<br>Ingenio La Cabaña Colombia`,
        },
        {
          name: "Argentina",
          lat: -34.6,
          lng: -58.4,
          info: `Ingenio Concepción<br>Ingenio Bella Vista<br>Ingenio La Florida<br>Ingenio La Fronterita<br>Ingenio La Providencia<br>Ingenio La Trinidad<br>Ingenio Leales<br>Ingenio Marapa<br>Ingenio Ñuñorco<br>Ingenio San Juan<br>Ingenio Santa Bárbara<br>Ingenio La Esperanza<br>Ingenio Río Grande`,
        }
      ];

      const globe = Globe()(document.getElementById("globeViz"))
        .globeImageUrl(
          "https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg"
        )
        .labelsData(labels)
        .labelText(() => "")
        .labelLat(d => d.lat)
        .labelLng(d => d.lng)
        .labelDotRadius(0)
        .htmlElementsData(labels)
        .htmlElement((d) => {
          const el = document.createElement("div");
          el.className = "label-sci";

          const list = d.info
            ? `<ul>${d.info
                .split("<br>")
                .map(i => `<li>${i}</li>`)
                .join("")}</ul>`
            : "";

          el.innerHTML = `
            ${d.name}
            <div class="tooltip">${list}</div>
          `;
          return el;
        });

      fetch("https://unpkg.com/world-atlas@2/countries-50m.json")
        .then(res => res.json())
        .then(data => {
          const geo = topojson.feature(
            data,
            data.objects.countries
          ).features;

          globe
            .polygonsData(
              geo.filter(f => latam.includes(f.properties.name))
            )
            .polygonCapColor(() => "rgba(0,0,0,0)")
            .polygonSideColor(() => "rgba(0,0,0,0)")
            .polygonStrokeColor(() => "rgb(0,155,90)")
            .polygonStrokeWidth(0.5)
            .polygonAltitude(0.02);
        });

      globe.controls().autoRotate = false;
      globe.controls().autoRotateSpeed = 0.05;
    </script>
  </body>
</html>
